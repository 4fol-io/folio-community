(()=>{var ft=Object.create;var Q=Object.defineProperty;var dt=Object.getOwnPropertyDescriptor;var ct=Object.getOwnPropertyNames;var mt=Object.getPrototypeOf,pt=Object.prototype.hasOwnProperty;var gt=(n,s,g)=>s in n?Q(n,s,{enumerable:!0,configurable:!0,writable:!0,value:g}):n[s]=g;var z=(n,s)=>()=>(s||n((s={exports:{}}).exports,s),s.exports);var _t=(n,s,g,v)=>{if(s&&typeof s=="object"||typeof s=="function")for(let u of ct(s))!pt.call(n,u)&&u!==g&&Q(n,u,{get:()=>s[u],enumerable:!(v=dt(s,u))||v.enumerable});return n};var Z=(n,s,g)=>(g=n!=null?ft(mt(n)):{},_t(s||!n||!n.__esModule?Q(g,"default",{value:n,enumerable:!0}):g,n));var U=(n,s,g)=>(gt(n,typeof s!="symbol"?s+"":s,g),g);var V=z((K,X)=>{(function(n,s){typeof K=="object"&&typeof X!="undefined"?X.exports=s():typeof define=="function"&&define.amd?define(s):(n=typeof globalThis!="undefined"?globalThis:n||self).dayjs=s()})(K,function(){"use strict";var n=1e3,s=6e4,g=36e5,v="millisecond",u="second",T="minute",j="hour",_="day",w="week",b="month",W="quarter",Y="year",O="date",k="Invalid Date",A=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,H=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(r){var i=["th","st","nd","rd"],t=r%100;return"["+r+(i[(t-20)%10]||i[t]||i[0])+"]"}},l=function(r,i,t){var o=String(r);return!o||o.length>=i?r:""+Array(i+1-o.length).join(t)+r},c={s:l,z:function(r){var i=-r.utcOffset(),t=Math.abs(i),o=Math.floor(t/60),e=t%60;return(i<=0?"+":"-")+l(o,2,"0")+":"+l(e,2,"0")},m:function r(i,t){if(i.date()<t.date())return-r(t,i);var o=12*(t.year()-i.year())+(t.month()-i.month()),e=i.clone().add(o,b),h=t-e<0,a=i.clone().add(o+(h?-1:1),b);return+(-(o+(t-e)/(h?e-a:a-e))||0)},a:function(r){return r<0?Math.ceil(r)||0:Math.floor(r)},p:function(r){return{M:b,y:Y,w,d:_,D:O,h:j,m:T,s:u,ms:v,Q:W}[r]||String(r||"").toLowerCase().replace(/s$/,"")},u:function(r){return r===void 0}},f="en",y={};y[f]=d;var x=function(r){return r instanceof R},C=function r(i,t,o){var e;if(!i)return f;if(typeof i=="string"){var h=i.toLowerCase();y[h]&&(e=h),t&&(y[h]=t,e=h);var a=i.split("-");if(!e&&a.length>1)return r(a[0])}else{var m=i.name;y[m]=i,e=m}return!o&&e&&(f=e),e||!o&&f},D=function(r,i){if(x(r))return r.clone();var t=typeof i=="object"?i:{};return t.date=r,t.args=arguments,new R(t)},p=c;p.l=C,p.i=x,p.w=function(r,i){return D(r,{locale:i.$L,utc:i.$u,x:i.$x,$offset:i.$offset})};var R=function(){function r(t){this.$L=C(t.locale,null,!0),this.parse(t)}var i=r.prototype;return i.parse=function(t){this.$d=function(o){var e=o.date,h=o.utc;if(e===null)return new Date(NaN);if(p.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var a=e.match(A);if(a){var m=a[2]-1||0,$=(a[7]||"0").substring(0,3);return h?new Date(Date.UTC(a[1],m,a[3]||1,a[4]||0,a[5]||0,a[6]||0,$)):new Date(a[1],m,a[3]||1,a[4]||0,a[5]||0,a[6]||0,$)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},i.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},i.$utils=function(){return p},i.isValid=function(){return this.$d.toString()!==k},i.isSame=function(t,o){var e=D(t);return this.startOf(o)<=e&&e<=this.endOf(o)},i.isAfter=function(t,o){return D(t)<this.startOf(o)},i.isBefore=function(t,o){return this.endOf(o)<D(t)},i.$g=function(t,o,e){return p.u(t)?this[o]:this.set(e,t)},i.unix=function(){return Math.floor(this.valueOf()/1e3)},i.valueOf=function(){return this.$d.getTime()},i.startOf=function(t,o){var e=this,h=!!p.u(o)||o,a=p.p(t),m=function(N,L){var P=p.w(e.$u?Date.UTC(e.$y,L,N):new Date(e.$y,L,N),e);return h?P:P.endOf(_)},$=function(N,L){return p.w(e.toDate()[N].apply(e.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(L)),e)},M=this.$W,S=this.$M,B=this.$D,F="set"+(this.$u?"UTC":"");switch(a){case Y:return h?m(1,0):m(31,11);case b:return h?m(1,S):m(0,S+1);case w:var q=this.$locale().weekStart||0,J=(M<q?M+7:M)-q;return m(h?B-J:B+(6-J),S);case _:case O:return $(F+"Hours",0);case j:return $(F+"Minutes",1);case T:return $(F+"Seconds",2);case u:return $(F+"Milliseconds",3);default:return this.clone()}},i.endOf=function(t){return this.startOf(t,!1)},i.$set=function(t,o){var e,h=p.p(t),a="set"+(this.$u?"UTC":""),m=(e={},e[_]=a+"Date",e[O]=a+"Date",e[b]=a+"Month",e[Y]=a+"FullYear",e[j]=a+"Hours",e[T]=a+"Minutes",e[u]=a+"Seconds",e[v]=a+"Milliseconds",e)[h],$=h===_?this.$D+(o-this.$W):o;if(h===b||h===Y){var M=this.clone().set(O,1);M.$d[m]($),M.init(),this.$d=M.set(O,Math.min(this.$D,M.daysInMonth())).$d}else m&&this.$d[m]($);return this.init(),this},i.set=function(t,o){return this.clone().$set(t,o)},i.get=function(t){return this[p.p(t)]()},i.add=function(t,o){var e,h=this;t=Number(t);var a=p.p(o),m=function(S){var B=D(h);return p.w(B.date(B.date()+Math.round(S*t)),h)};if(a===b)return this.set(b,this.$M+t);if(a===Y)return this.set(Y,this.$y+t);if(a===_)return m(1);if(a===w)return m(7);var $=(e={},e[T]=s,e[j]=g,e[u]=n,e)[a]||1,M=this.$d.getTime()+t*$;return p.w(M,this)},i.subtract=function(t,o){return this.add(-1*t,o)},i.format=function(t){var o=this,e=this.$locale();if(!this.isValid())return e.invalidDate||k;var h=t||"YYYY-MM-DDTHH:mm:ssZ",a=p.z(this),m=this.$H,$=this.$m,M=this.$M,S=e.weekdays,B=e.months,F=function(L,P,G,E){return L&&(L[P]||L(o,h))||G[P].slice(0,E)},q=function(L){return p.s(m%12||12,L,"0")},J=e.meridiem||function(L,P,G){var E=L<12?"AM":"PM";return G?E.toLowerCase():E},N={YY:String(this.$y).slice(-2),YYYY:this.$y,M:M+1,MM:p.s(M+1,2,"0"),MMM:F(e.monthsShort,M,B,3),MMMM:F(B,M),D:this.$D,DD:p.s(this.$D,2,"0"),d:String(this.$W),dd:F(e.weekdaysMin,this.$W,S,2),ddd:F(e.weekdaysShort,this.$W,S,3),dddd:S[this.$W],H:String(m),HH:p.s(m,2,"0"),h:q(1),hh:q(2),a:J(m,$,!0),A:J(m,$,!1),m:String($),mm:p.s($,2,"0"),s:String(this.$s),ss:p.s(this.$s,2,"0"),SSS:p.s(this.$ms,3,"0"),Z:a};return h.replace(H,function(L,P){return P||N[L]||a.replace(":","")})},i.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},i.diff=function(t,o,e){var h,a=p.p(o),m=D(t),$=(m.utcOffset()-this.utcOffset())*s,M=this-m,S=p.m(this,m);return S=(h={},h[Y]=S/12,h[b]=S,h[W]=S/3,h[w]=(M-$)/6048e5,h[_]=(M-$)/864e5,h[j]=M/g,h[T]=M/s,h[u]=M/n,h)[a]||M,e?S:p.a(S)},i.daysInMonth=function(){return this.endOf(b).$D},i.$locale=function(){return y[this.$L]},i.locale=function(t,o){if(!t)return this.$L;var e=this.clone(),h=C(t,o,!0);return h&&(e.$L=h),e},i.clone=function(){return p.w(this.$d,this)},i.toDate=function(){return new Date(this.valueOf())},i.toJSON=function(){return this.isValid()?this.toISOString():null},i.toISOString=function(){return this.$d.toISOString()},i.toString=function(){return this.$d.toUTCString()},r}(),ot=R.prototype;return D.prototype=ot,[["$ms",v],["$s",u],["$m",T],["$H",j],["$W",_],["$M",b],["$y",Y],["$D",O]].forEach(function(r){ot[r[1]]=function(i){return this.$g(i,r[0],r[1])}}),D.extend=function(r,i){return r.$i||(r(i,R,D),r.$i=!0),D},D.locale=C,D.isDayjs=x,D.unix=function(r){return D(1e3*r)},D.en=y[f],D.Ls=y,D.p={},D})});var at=z((tt,et)=>{(function(n,s){typeof tt=="object"&&typeof et!="undefined"?et.exports=s():typeof define=="function"&&define.amd?define(s):(n=typeof globalThis!="undefined"?globalThis:n||self).dayjs_plugin_relativeTime=s()})(tt,function(){"use strict";return function(n,s,g){n=n||{};var v=s.prototype,u={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function T(_,w,b,W){return v.fromToBase(_,w,b,W)}g.en.relativeTime=u,v.fromToBase=function(_,w,b,W,Y){for(var O,k,A,H=b.$locale().relativeTime||u,d=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],l=d.length,c=0;c<l;c+=1){var f=d[c];f.d&&(O=W?g(_).diff(b,f.d,!0):b.diff(_,f.d,!0));var y=(n.rounding||Math.round)(Math.abs(O));if(A=O>0,y<=f.r||!f.r){y<=1&&c>0&&(f=d[c-1]);var x=H[f.l];Y&&(y=Y(""+y)),k=typeof x=="string"?x.replace("%d",y):x(y,w,f.l,A);break}}if(w)return k;var C=A?H.future:H.past;return typeof C=="function"?C(k):C.replace("%s",k)},v.to=function(_,w){return T(_,w,this,!0)},v.from=function(_,w){return T(_,w,this)};var j=function(_){return _.$u?g.utc():g()};v.toNow=function(_){return this.to(j(this),_)},v.fromNow=function(_){return this.from(j(this),_)}}})});var ht=z((it,nt)=>{(function(n,s){typeof it=="object"&&typeof nt!="undefined"?nt.exports=s(V()):typeof define=="function"&&define.amd?define(["dayjs"],s):(n=typeof globalThis!="undefined"?globalThis:n||self).dayjs_locale_ca=s(n.dayjs)})(it,function(n){"use strict";function s(u){return u&&typeof u=="object"&&"default"in u?u:{default:u}}var g=s(n),v={name:"ca",weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),months:"Gener_Febrer_Mar\xE7_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar\xE7_Abr._Maig_Juny_Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM [de] YYYY",LLL:"D MMMM [de] YYYY [a les] H:mm",LLLL:"dddd D MMMM [de] YYYY [a les] H:mm",ll:"D MMM YYYY",lll:"D MMM YYYY, H:mm",llll:"ddd D MMM YYYY, H:mm"},relativeTime:{future:"d'aqu\xED %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:function(u){return""+u+(u===1||u===3?"r":u===2?"n":u===4?"t":"\xE8")}};return g.default.locale(v,null,!0),v})});var ut=z((st,rt)=>{(function(n,s){typeof st=="object"&&typeof rt!="undefined"?rt.exports=s(V()):typeof define=="function"&&define.amd?define(["dayjs"],s):(n=typeof globalThis!="undefined"?globalThis:n||self).dayjs_locale_es=s(n.dayjs)})(st,function(n){"use strict";function s(u){return u&&typeof u=="object"&&"default"in u?u:{default:u}}var g=s(n),v={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mi\xE9rcoles_jueves_viernes_s\xE1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xE9._jue._vie._s\xE1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xE1".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xEDa",dd:"%d d\xEDas",M:"un mes",MM:"%d meses",y:"un a\xF1o",yy:"%d a\xF1os"},ordinal:function(u){return u+"\xBA"}};return g.default.locale(v,null,!0),v})});var I=Z(V()),lt=Z(at()),Mt=Z(ht()),vt=Z(ut());(function(n,s){s.hasOwnProperty("lang")&&(s.lang==="es"||s.lang==="ca")&&I.default.locale(s.lang);let g=350,v=250,u=null,T=[],j=(0,I.default)(),_=n(".folio-comm-refresh-time");var w=function(d){var l=function(){d.style.display="block";var f=d.scrollHeight+"px";return d.style.display="",f},c=l();d.classList.add("is-visible"),d.style.height=c,setTimeout(function(){d.style.height=""},g)},b=function(d){d.style.height=d.scrollHeight+"px",setTimeout(function(){d.style.height="0"},1),setTimeout(function(){d.classList.remove("is-visible")},v)},W=function(d,l){if(d.classList.contains("is-visible")){hide(d);return}show(d)};class Y{constructor(l){U(this,"showSearchLoading",()=>{this.type==="search"&&this.pagination==="pages"&&(console.log("show",this.type),this.contentWrapper.length&&(this.fieldWrapper.length&&this.fieldWrapper.find(".folio-comm-loading").removeClass("folio-comm-hidden"),b(this.contentWrapper[0])))});U(this,"hideSearchLoading",()=>{this.type==="search"&&this.pagination==="pages"&&this.contentWrapper.length&&(console.log("hide",this.type),setTimeout(()=>{this.fieldWrapper.length&&this.fieldWrapper.find(".folio-comm-loading").addClass("folio-comm-hidden"),w(this.contentWrapper[0])},350))});U(this,"refresh",()=>{if(this.isRefresh=!0,this.moreContent.data("page",1).attr("data-page",1),this.type==="search"&&this.pagination==="pages"?this.moreContent.show():this.moreContent.html("").show(),this.pagination!=="pages")this.moreButton.show();else{let l=this.type==="pubs"?"pp":"pq";this.updateUrlParam(l)}this.type==="search"&&(this.updateUrlParam("f",this.searchFilters),this.updateUrlParam("q",this.searchForm.find('input[name="q"]').val())),this.showSearchLoading(),this.handleLoadMore()});U(this,"hideLoadMoreIfOnLastPage",l=>{l+1>this.totalPages&&this.moreButton.hide()});U(this,"updateUrlParam",(l,c)=>{if(typeof URLSearchParams!="undefined"){let f=new URLSearchParams(location.search);f.has(l)&&f.delete(l),typeof c!="undefined"&&f.append(l,c),window.history&&history.replaceState&&history.replaceState(null,"","?"+f+location.hash)}});var c,f;this.type=l!=null?l:"pubs",this.totalPages=0,this.paginationBase="%_%",this.ajaxUrl=(c=s.ajax_url)!=null?c:"",this.ajaxNonce=(f=s.ajax_nonce)!=null?f:"",this.ajaxAction="folio_comm_load_more_"+this.type,this.refreshButton=n("#folio-comm-refresh-"+this.type+"-btn"),this.moreButton=n("#folio-comm-load-more-"+this.type+"-btn"),this.contentWrapper=n(".folio-comm-search-results-wrapper"),this.fieldWrapper=n(".folio-comm-search-field-wrapper"),this.moreContent=n("#folio-comm-load-more-"+this.type+"-content"),this.morePaging=n("#folio-comm-load-more-"+this.type+"-paging"),this.isRefresh=!1,this.searchFilters=[],this.searchForm=n(".folio-comm-search-form"),this.pagination=this.moreButton.length?this.moreButton.hasClass("folio-comm-more-btn")?"more":"infinite":"pages",this.options={root:null,rootMargin:"50px 0px",threshold:0},this.init()}init(){this.moreContent.length&&(this.paginationBase=this.moreContent.data("base")),this.type==="search"&&this.searchForm.find('input[name="q"]').val()&&(this.showSearchLoading(),this.hideSearchLoading()),this.morePaging.length&&(this.totalPages=this.morePaging.data("total-pages"),this.totalPages>1&&this.moreButton.show()),this.pagination==="infinite"&&new IntersectionObserver(c=>this.intersectionObserverCallback(c),this.options).observe(this.moreButton[0]),this.setupEvents()}setupEvents(){this.refreshButton.length&&this.refreshButton.on("click",l=>{l.preventDefault(),j=(0,I.default)(),T=[],this.refresh()}),this.pagination==="more"&&this.moreButton.on("click",()=>{this.handleLoadMore()}),this.type==="search"&&(this.filter=n('.folio-comm-search-filters :checkbox[name="f"]'),this.searchFilters=this.getSearchFilters(),this.filter.on("change",l=>{this.searchFilters=this.getSearchFilters(),this.checkSearchAction()}),this.searchForm.on("submit",l=>{let c=this.searchForm.find('input[name="q"]');return c.val()?this.searchFilters.length?(l.preventDefault(),this.refresh(),!1):!0:(l.preventDefault(),c.trigger("focus"),!1)}))}getSearchFilters(){return n('.folio-comm-search-filters :checkbox[name="f"]:checked').map((l,c)=>c.value).get()}checkSearchAction(){this.searchFilters.length?this.searchForm.attr("target","_self").attr("action",this.searchForm.data("local-action")):this.searchForm.attr("target","_blank").attr("action",this.searchForm.data("external-action"))}intersectionObserverCallback(l){l.forEach(c=>{c!=null&&c.isIntersecting&&(this.isRefresh||this.handleLoadMore())})}handleLoadMore(){let l=this.moreContent.data("page"),c=this.moreContent.data("per-page");if(!l)return null;let f=parseInt(l)+1;this.isRefresh&&(f=1),this.pagination==="more"&&(this.moreButton.children(".folio-comm-label").addClass("folio-comm-hidden"),this.moreButton.children(".folio-comm-loading").removeClass("folio-comm-hidden"),this.moreButton.addClass("loading"));var y=new FormData;y.append("page",f),y.append("per_page",c),y.append("is_refresh",this.isRefresh),y.append("pagination",this.pagination),y.append("base",this.paginationBase+location.search.replace("?","&")),y.append("action",this.ajaxAction),y.append("ajax_nonce",this.ajaxNonce),this.type==="search"&&(this.searchFilters=this.getSearchFilters(),y.append("filters",this.searchFilters),y.append("search",this.searchForm.find('input[name="q"]').val())),n.ajax({url:this.ajaxUrl,type:"post",data:y,processData:!1,contentType:!1,success:x=>{if(x!=="0"){let C=null;if(this.type==="search"&&this.pagination==="pages"&&this.moreContent.html(""),this.pagination==="more"&&(C=this.moreContent.children().last()),this.moreContent.append(x),this.pagination==="more"&&C&&C.length){let D=C.next();D.length&&D.trigger("focus")}}},error:x=>{console.log(x)},complete:()=>{this.morePaging=n("#folio-comm-load-more-"+this.type+"-paging"),this.totalPages=this.morePaging.length?this.morePaging.data("total-pages"):0,this.hideSearchLoading(),this.pagination!=="pages"&&this.moreContent.data("page",f).attr("data-page",f),this.pagination==="more"&&(this.moreButton.children(".folio-comm-label").removeClass("folio-comm-hidden"),this.moreButton.children(".folio-comm-loading").addClass("folio-comm-hidden"),this.moreButton.removeClass("loading")),this.isRefresh=!1,this.hideLoadMoreIfOnLastPage(f),this.type==="pubs"&&k()}})}}let O=function(){I.default.extend(lt.default),k()},k=function(){A(),H()},A=function(){n(".folio-comm-post-time:not('.processed')").each(function(){var d=n(this);T.push({id:d.attr("id"),time:(0,I.default)(d.attr("datetime"))}),d.addClass("processed")})},H=function(){u&&clearTimeout(u),T.forEach(function(d){n("#"+d.id).text(d.time.fromNow())}),_.text(j.fromNow()),u=setTimeout(H,6e4)};new Y("search"),new Y("pubs"),O()})(jQuery,typeof folioCommunityData!="undefined"?folioCommunityData:{});})();
